test_that("plot_sleep_bubbles handles valid input correctly", {
  sessions <- data.frame(
    time_at_sleep_onset = c("2025-03-03T11:24:11.524000+00:00",
                            "2025-03-04T14:44:11.524000+00:00",
                            "2025-03-05T18:24:11.524000+00:00",
                            "2025-03-06T00:24:11.524000+00:00",
                            "2025-03-07T23:24:11.524000+00:00"),
    time_at_wakeup = c("2025-03-03T11:24:11.524000+00:00",
                       "2025-03-04T14:44:11.524000+00:00",
                       "2025-03-05T18:24:11.524000+00:00",
                       "2025-03-06T00:24:11.524000+00:00",
                       "2025-03-07T23:24:11.524000+00:00"),
    night = as.POSIXct(c("2025-03-03", "2025-03-03", "2025-03-03", "2025-03-03", "2025-03-03"), tz = "UTC"),
    .data_type = "somnofy_v2"
  )

  plot <- plot_sleep_bubbles(sessions)

  expect_s3_class(plot, "ggplot")
})
